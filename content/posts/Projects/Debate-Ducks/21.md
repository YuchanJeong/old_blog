---
title: "[Debate-Ducks] 프로젝트 마무리"
date: 2022-08-09
categories:
  - <Projects>
tags:
  - "'Debate-Ducks'"
  - (Devlog)
---

## 헤더 개선 및 기타 에러 해결

_\*[Pull Request](https://github.com/SuSang-YuHee/Debate-Ducks-Client/pull/97)_

### 빈 팩트체크 표시

- 기존 팩트체크
  <img width="1200" alt="기존 팩트체크" src="https://user-images.githubusercontent.com/84524514/184529279-86996629-4056-4198-b8b3-b94a252629c8.png">

- 변경 후 팩트체크
  <img width="1200" alt="변경 후 팩트체크" src="https://user-images.githubusercontent.com/84524514/184529286-c4ccdda0-1036-418a-9b8b-552e6c0d42fa.png">

### 투표 - 0표일 때 처리

- 기존 투표
  <img width="800" alt="기존 투표" src="https://user-images.githubusercontent.com/84524514/184529662-23ab7aca-7f47-45ff-9dae-54582f4c5104.png">

- 변경 후 투표
  <img width="800" alt="변경 후 투표" src="https://user-images.githubusercontent.com/84524514/184529670-63083109-9791-4a82-828b-9c211556896c.png">

### 로그아웃 기능 개선

기존에는 로그아웃 시 로컬 저장소에서 토큰을 지우고, 메인 페이지로 보내주는 방식으로 되어있었습니다. 그래서 변경된 사항이 바로 사용자의 화면에 반영되지 않았다.

해당 부분의 개선을 위해 `queryClient.setQueryData([queryStr.users], () => null);` 처리를 해줘서 유저 접어보의 변경이 사용자의 화면에 바로 변경되게 하고, 메인 페이지로 보내는 기능은 필요 없다고 생각해 삭제했다.

### 헤더 스타일 변경

- 기존 헤더 (반응형 X)
  <img width="300" alt="기존 헤더" src="https://user-images.githubusercontent.com/84524514/184530147-ee74aa06-be35-43d0-b2e5-27ad7bcbeceb.png">

- 변경 후 헤더 (반응형 O)
  <img width="500" alt="변경 후 헤더1" src="https://user-images.githubusercontent.com/84524514/184530228-f5298494-b3d1-4ff2-97b0-d559a5458cc6.png">
  <img width="400" alt="변경 후 헤더2" src="https://user-images.githubusercontent.com/84524514/184530225-c3fb3891-5923-4a2d-bfd3-196139701f3d.png">
  <img width="500" alt="변경 후 헤더3" src="https://user-images.githubusercontent.com/84524514/184530245-3373c196-bba2-4ada-9794-109627529fe3.png">

### 이미지 경고 해결

이미지 관련 경고들이 떴는데 경고에 해결 방법이 명시되어 있어서 쉽게 해결했다.

1. 이미지에 `priority={true}` 추가
2. 부모 요소에 `position: relative;` 추가

## 로그인 및 회원가입 개선

_\*[Pull Request](https://github.com/SuSang-YuHee/Debate-Ducks-Client/pull/98)_

기존에는 로그인 시 메인 페이지로 보내는 방식으로 되어있었다. 하지만 로그인 직후 원래 보던 페이지로 돌아가는 게 더 적합하다고 판단해서 세션에 경로를 저장하는 방식으로 구현했다.

이 기능을 추가했기 때문에 이전에 만들었던 로그인 모달은 삭제해 줬다. 추가로 스크롤 위치도 기억해서 되돌아갈 수 있게 업데이트할 예정이다. <!-- #추가예정 -->

```tsx
useEffect(() => storePathValues, [router.asPath]);

function storePathValues() {
  const storage = globalThis?.sessionStorage;
  if (!storage) return;
  const prevPath = storage.getItem("currentPath");
  storage.setItem("prevPath", prevPath || "");
  storage.setItem("currentPath", globalThis.location.pathname);
}
```

```ts
login(userInfo.email, userInfo.password, () => {
  router.push("/");
  queryClient.invalidateQueries([queryStr.users]);
  user.refetch();
  const storage = globalThis?.sessionStorage;
  const link =
    storage.getItem("prevPath") === "/signin" ||
    storage.getItem("prevPath") === "/signup"
      ? "/"
      : storage.getItem("prevPath") || "/";
  router.push(link);
});
```

추가로 회원가입 시 비밀번호 암호화 과정으로 인해 발생한 대기시간 동안 대기 안내 모달을 띄워 사용자에게 알려주는 기능을 추가했다.

<img width="1200" alt="회원가입 중 모달" src="https://user-images.githubusercontent.com/84524514/184589670-98e4c5de-f616-435a-8e00-5bb1c6c24c6b.png">

## 토론 목록 상태관리 리덕스 사용

_\*[Pull Request](https://github.com/SuSang-YuHee/Debate-Ducks-Client/pull/99)_

토론 목록에서 필터링을 적용하거나 검색을 한 다음 토론 게시물을 보고 다시 돌아왔을 때 상태를 여전히 기억하고 있어야 한다. 하지만 기존에는 useState로만 지역적으로 관리되고 있었다. 그래서 리덕스를 사용해서 전역 상태로 관리하기로 했다.

Context API를 사용하지 않은 이유는 Context API로 관리되는 상태 값을 변경하면, Provider로 감싼 모든 자식 컴포넌트들이 릭 렌더링 되기 때문에 추가로 방어 코드를 작성해 줘야 하기 때문이다. 즉 Context API는 상태 관리보다는 정적인 값에 가까운 데이터를 전역적으로 사용할 때 사용하기 적합해서 이번에는 사용하지 않았다.

추가로 스크롤 위치도 기억해서 되돌아갈 수 있게 업데이트할 예정이다. <!-- #추가예정 -->
