---
title: "[땡땡능력시험] Styled-components 설정"
date: 2022-08-30
categories:
  - <Projects>
tags:
  - "'땡땡능력시험'"
  - (Devlog)
---

## 설치

```bash
npm i styled-components styled-normalize

npm i -D @types/styled-components
```

## 테마 스타일

- 유지 보수성을 위해 테마별 스타일의 값들 미리 지정

styles/theme.ts

```ts
//# 사이즈
export const size = {
  sm: ".5rem",
  md: "1rem",
  lg: "2rem",
  xl: "3rem",
};

//# 폰트
export const fonts = {
  family: {
    san_serif: "sans-serif",
    serif: "serif",
  },
  size: {
    sm: "1.4rem",
    md: "1.6rem",
    lg: "2rem",
    xl: "2.5rem",
    title: "6rem",
  },
  weight: {
    light: 100,
    normal: 400,
    bold: 700,
  },
};

//# 미디어 쿼리
const mediaSize = {
  mobile: "425px",
  tablet: "768px",
  laptop: "1024px",
};

export const device = {
  mobile: `@media only screen and (max-width: ${mediaSize.mobile})`,
  tablet: `@media only screen and (max-width: ${mediaSize.tablet})`,
  laptop: `@media only screen and (max-width: ${mediaSize.laptop})`,
};

//# 색상
const colors = {
  red: "#ff4d4d",
  yellow: "#ffff4d",
  blue: "#0099ff",
};

export const lightThemeColors = {
  ...colors,
  primary: "#333",
  secondary: "#fff",
  tertiary: "#808080",
};

const darkThemeColors = {
  ...colors,
  primary: "#fff",
  secondary: "#333",
  tertiary: "#d4d0c4",
};

//# 공통 스타일 모음
const defaultStyle = {
  size,
  fonts,
  device,
};

//# 각 테마
export const lightTheme = {
  ...defaultStyle,
  colors: lightThemeColors,
};

export const darkTheme = {
  ...defaultStyle,
  colors: darkThemeColors,
};
```

## 테마 타입

- 각 목록의 구성 변경 시 따로 타입을 수정하지 않아 되게 만듦

styles/styled.d.ts

```ts
import { device, fonts, lightThemeColors, size } from "./theme";

declare module "styled-components" {
  export interface DefaultTheme {
    size: typeof size;
    fonts: typeof fonts;
    device: typeof device;
    colors: typeof lightThemeColors;
  }
}
```

## 공용 스타일

- normalize로 브라우저별로 다른 스타일 통일 [[참조]](https://necolas.github.io/normalize.css/latest/normalize.css)

styles/GlobalStyle.ts

```ts
import { createGlobalStyle, css } from "styled-components";
import { normalize } from "styled-normalize";

const GlobalStyle = createGlobalStyle`
  ${normalize} //> 참조: https://necolas.github.io/normalize.css/latest/normalize.css
  
  * {
    box-sizing: border-box;
  } 

  html {
    font-size: 62.5%; //> 1rem = 10px;  
  }
  
  ${({ theme }) => {
    return css`
      body {
        font-family: ${theme.fonts.family.san_serif};
        font-weight: ${theme.fonts.weight.normal};
        font-size: ${theme.fonts.size.md};
      }
    `;
  }}
`;

export default GlobalStyle;
```

## 테마 및 공용 스타일 적용

- ThemeProvider로 테마 props 전역 공급
- 그 덕에 테마를 변경하는 `toggleTheme`만 Header에 전달 (따로 전역 관리 필요 X)
- 공용 스타일 적용

pages/\_app.tsx

```ts
import type { AppProps } from "next/app";
import Head from "next/head";
import { ThemeProvider } from "styled-components";

import Header from "../components/header/Header";
import { useThemeInLocalStorage } from "../hooks/useThemeInLocalStorage";
import GlobalStyle from "../styles/GlobalStyle";
import { darkTheme, lightTheme } from "../styles/theme";

function MyApp({ Component, pageProps }: AppProps) {
  const { isDarkMode, toggleTheme } = useThemeInLocalStorage();

  return (
    <>
      <Head>
        <title>땡땡능력시험</title>
      </Head>
      <ThemeProvider theme={isDarkMode ? darkTheme : lightTheme}>
        <GlobalStyle />
        <Header isDarkMode={isDarkMode} toggleTheme={toggleTheme} />
        <Component {...pageProps} />;
      </ThemeProvider>
    </>
  );
}

export default MyApp;
```

## 로컬 스토리지로 테마 저장 Hook❗️

- 로컬 스토리지를 활용하는 테마 상태 관리 커스텀 훅
- 수화 불일치 문제를 피하기 위해 useEffect 사용
- `typeof window === "undefined"` 사용 시 문제 발생

hooks/useThemeInLocalStorage.ts

```ts
import { useEffect, useState } from "react";

/**
 * \# 로컬 스토리지로 테마 상태 관리
 * @returns \{ isDarkMode: 다크 모드 여부, toggleTheme: 테마 전환 함수 }
 */
export const useThemeInLocalStorage = () => {
  const [isDarkMode, setIsDarkMode] = useState<boolean>(false);

  //> 수화 불일치 문제 대비 (typeof window === "undefined" 사용 시 문제 발생)
  useEffect(() => {
    setIsDarkMode(localStorage.getItem("isDarkMode") === "true" ? true : false);
  }, []);

  const toggleTheme = () => {
    setIsDarkMode((prevState) => {
      localStorage.setItem("isDarkMode", `${!prevState}`);
      return !prevState;
    });
  };

  return { isDarkMode, toggleTheme };
};
```

## "Prop `className` did not match." 에러 [^](https://github.com/YuchanJeong/ddangddang-avility-test/issues/2)

**\# 문제**

<img width="800" alt="Prop `className` did not match." src="https://user-images.githubusercontent.com/84524514/187668860-f36a6a4d-e7ad-483c-804b-d3e3d712f484.png">

**\# 해결**

`babel-plugin-styled-components`로 환경과 상관없이 일관된 className을 생성

```bash
npm i -D babel-plugin-styled-components
```
