---
title: "[땡땡능력시험] Styled-components 설정 및 헤더•푸터"
date: 2022-08-30
categories:
  - <Projects>
tags:
  - "'땡땡능력시험'"
  - (Devlog)
---

\*PR. https://github.com/YuchanJeong/ddangddang-avility-test/pull/3

## Styled-components 설정

### 설치

```bash
npm i styled-components styled-normalize
npm i -D @types/styled-components
```

### 테마 스타일

- 유지 보수성을 위해 테마별 스타일의 값들을 미리 지정

styles/theme.ts

```ts
//# 사이즈
export const size = {
  sm: ".5rem",
  md: "1rem",
  lg: "2rem",
  xl: "3rem",
};

//# 폰트
export const fonts = {
  family: {
    san_serif: "sans-serif",
    serif: "serif",
  },
  size: {
    sm: "1.4rem",
    md: "1.6rem",
    lg: "2rem",
    xl: "2.5rem",
    xxl: "3rem",
    title: "6rem",
  },
  weight: {
    light: 100,
    normal: 400,
    bold: 700,
  },
};

//# 미디어 쿼리 (부트스트랩 기준)
const mediaSize = {
  mobile: "576px",
  tablet: "768px",
  laptop: "992px",
};

export const device = {
  mobile: `@media only screen and (max-width: ${mediaSize.mobile})`,
  tablet: `@media only screen and (max-width: ${mediaSize.tablet})`,
  laptop: `@media only screen and (max-width: ${mediaSize.laptop})`,
};

//# 색상
const colors = {
  accent: "#7F00FF",
};

export const lightThemeColors = {
  ...colors,
  text: "#222120",
  primary: "#FAFAFA",
};

const darkThemeColors = {
  ...colors,
  text: "#FAFAFA",
  primary: "#222120",
};

//# 공통 스타일 모음
const defaultStyle = {
  size,
  fonts,
  device,
};

//# 각 테마
export const lightTheme = {
  ...defaultStyle,
  colors: lightThemeColors,
};

export const darkTheme = {
  ...defaultStyle,
  colors: darkThemeColors,
};

//# 기본 테마
declare module "styled-components" {
  export interface DefaultTheme {
    size: typeof size;
    fonts: typeof fonts;
    device: typeof device;
    colors: typeof lightThemeColors;
  }
}
```

### 공용 스타일

- normalize로 브라우저별로 다른 스타일 통일 [[참조]](https://necolas.github.io/normalize.css/latest/normalize.css)

styles/GlobalStyle.tsx

```ts
import { createGlobalStyle, css } from "styled-components";
import { normalize } from "styled-normalize";

const GlobalStyle = createGlobalStyle`
  ${normalize} //> 참조: https://necolas.github.io/normalize.css/latest/normalize.css
  
  * {
    box-sizing: border-box;
  } 

  html {
    font-size: 62.5%; //> 1rem = 10px;  
  }
  
  ${({ theme }) => {
    return css`
      body {
        font-family: ${theme.fonts.family.san_serif};
        font-weight: ${theme.fonts.weight.normal};
        font-size: ${theme.fonts.size.md};
      }
    `;
  }}
`;

export default GlobalStyle;
```

### 테마 및 공용 스타일 적용

- `ThemeProvider`로 테마 전역 공급
- `GlobalStyle`로 공용 스타일 적용

pages/\_app.tsx

```ts
import type { AppProps } from "next/app";
import Head from "next/head";
import { ThemeProvider } from "styled-components";

import GlobalStyle from "../styles/GlobalStyle";
import { darkTheme, lightTheme } from "../styles/theme";

function MyApp({ Component, pageProps }: AppProps) {
  return (
    <>
      <Head>
        <title>땡땡능력시험</title>
      </Head>
      <ThemeProvider theme={isDarkMode ? darkTheme : lightTheme}>
        <GlobalStyle />
        <Component {...pageProps} />;
      </ThemeProvider>
    </>
  );
}

export default MyApp;
```

## 로컬 스토리지 테마 상태 관리 Hook

- 로컬 스토리지로 테마 상태를 관리하는 커스텀 훅
- 수화 불일치 문제를 예방하기 위해 Dependency가 빈 배열인 useEffect 사용 (`typeof window === "undefined"` 사용 시 문제 발생)

hooks/useThemeInLocalStorage.ts

```ts
import { useEffect, useState } from "react";

/**
 * \# 로컬 스토리지로 테마 상태 관리
 * @returns \{ `isDarkMode`: 다크 모드 여부, `toggleTheme`: 테마 전환 함수 }
 */
export const useThemeInLocalStorage = () => {
  const [isDarkMode, setIsDarkMode] = useState<boolean>(false);

  //> 수화 불일치 문제 예방 (typeof window === "undefined" 사용 시 문제 발생)
  useEffect(() => {
    setIsDarkMode(localStorage.getItem("isDarkMode") === "true" ? true : false);
  }, []);

  const toggleTheme = () => {
    setIsDarkMode((prevState) => {
      localStorage.setItem("isDarkMode", `${!prevState}`);
      return !prevState;
    });
  };

  return { isDarkMode, toggleTheme };
};
```

## className 에러

\*Issue. https://github.com/YuchanJeong/ddangddang-avility-test/issues/2

**\# 문제**

“Prop `className` did not match.” 에러 발생

<img width="800" alt="Prop `className` did not match." src="https://user-images.githubusercontent.com/84524514/187668860-f36a6a4d-e7ad-483c-804b-d3e3d712f484.png">

**\# 해결**

`babel-plugin-styled-components`로 환경과 상관없이 일관된 className을 생성

```bash
npm i -D babel-plugin-styled-components
```

`.babelrc` 작성

```json
{
  "presets": ["next/babel"],
  "plugins": ["babel-plugin-styled-components"]
}
```

참조. [Prop `className` did not match](https://blog.shift.moe/2021/01/02/prop-classname-did-not-match/)
